name: Check for new versions of Nim
on:
  schedule:
    - cron: '0 0 * * *'

jobs:
  render:
    name: Render build.yml
    runs-on: ubuntu-latest

    steps:
    - name: Checkout repo
      uses: actions/checkout@v2
      with:
        fetch-depth: 1
        submodules: recursive

    - uses: actions/setup-python@v2
      with:
        python-version: '3.9'

    - name: Check for new Nim versions
      run: |
        pip install -r requirements.tx
        python3.9 render_build_yml.py
        git add .
        if [ "$(git diff --name-only --cached | grep .github/workflows/build.yml)" != "" ]
        then
          git commit -m "Re-rendered build.yml"
          git push
        fi
